<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>
<link href="css/style.css" media="all" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="lib/embr/src/lib/require.js"></script>
<script type="text/javascript" src="main.js"></script>
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
<script type="text/javascript">

"use strict";

if(!window.requestAnimationFrame){
    window.requestAnimationFrame = (function(){
        return window.webkitRequestAnimationFrame ||
               window.mozRequestAnimationFrame    ||
               window.oRequestAnimationFrame      ||
               window.msRequestAnimationFrame     ||
               function(callback, element){
                   window.setTimeout(callback, 1000 / 60);
               };
    })();
}

</script>
</head>
<body>
    <div id="left">
        <canvas id="gl-canvas" class="grabbable"></canvas>
<textarea id="code" class="shut" style="visibility:hidden" spellcheck="false">
uniform sampler2D texture;
uniform float scale, aspect, time;
uniform mat3 transform;

varying vec2 v_texcoord;

#define PI   3.141592653589793
#define PI_2 1.570796326794897

void main(){
    vec2 rads = vec2(PI * 2., PI);
    float x = (v_texcoord.x - .5) * scale;
    float y = (v_texcoord.y - .5) * scale * aspect;

    // Project to Sphere
    vec3 sphere_pnt = vec3(
        (2. * x) / (1. + x*x + y*y),
        (2. * y) / (1. + x*x + y*y),
        (x*x + y*y - 1.) / (1. + x*x + y*y)
    );
    sphere_pnt *= transform;

    // Convert to Spherical Coordinates
    float r = length(sphere_pnt);
    float lon = atan(sphere_pnt.y, sphere_pnt.x);
    float lat = acos(sphere_pnt.z / r);

    gl_FragColor = texture2D(texture, vec2(lon, lat) / rads);
}
</textarea>
        <svg id="code-toggle" title="Toggle Shader Source" class="shut" width="30" height="30" version="1.2" xmlns="http://www.w3.org/2000/svg">
            <g transform="translate(15,15)">
                <circle cx="0" cy="0" r="13"/>
                <path d="M -7,0 L 7,0 M 0,-7 L 0,7"/>
            </g>
        </svg>
        <div id="panoui">
            <a id="above" href="#">above</a>
            <a id="below" href="#">below</a>
            <a id="fullwindow" class="r" href="#">fullwindow</a>
        </div>
    </div>
    <div id="right">
        <div id="map"></div>
        <div id="mapui">
            <div class="input-border">
                <input id="location" type="text" value="hello" tabindex="0" spellcheck="false"
                    onfocus="this.parentNode.classList.add('focus')"
                    onblur="this.parentNode.classList.remove('focus')"/>
            </div>
        </div>
    </div>
</body>
</html>
